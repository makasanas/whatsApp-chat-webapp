<div class="flex align-items-center justify-content-end">
  <button class="btn" (click)="syncProduct()">
    <span>Sync Product</span>
  </button>
</div>

<div class="content">
  <div class="table-responsive" *ngIf="products.length != 0">
    <ngx-datatable class="material new-styled" [rows]="products" [rowClass]="getRowClass" [columns]="columns"
      [headerHeight]="50" [footerHeight]="50" [externalPaging]="true" [rowHeight]="'auto'" [columnMode]="'force'"
      [limit]="page.limit" [offset]="page.offset" [count]="page.count" (page)="getByPage($event)">
      <ngx-datatable-column [resizeable]="false" [width]="300" [canAutoResize]="false">
        <ng-template let-column="column" ngx-datatable-header-template>
          Title
        </ng-template>
        <ng-template let-row="row" ngx-datatable-cell-template>
          <span *ngIf="row.shopifyData">
            <span *ngIf="row.shopifyData.title"><a
                href="https://{{user.domain}}/{{scanType}}/{{row.shopifyData.handle}}"
                target="_blank">{{row.shopifyData.title}}</a></span>
          </span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column [resizeable]="false" [width]="200">
        <ng-template let-column="column" ngx-datatable-header-template>
          Scan Count
        </ng-template>
        <ng-template let-row="row" ngx-datatable-cell-template>
          <span>{{row.seoScanCount}}</span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column [resizeable]="false" [canAutoResize]="true" [width]="150">
        <ng-template let-column="column" class="text-left" ngx-datatable-header-template>
          Seo Issues
        </ng-template>
        <ng-template let-row="row" ngx-datatable-cell-template>
          <span *ngIf="row.seoScan">
            <div class="issues" *ngIf="row.seoScan.errCount">
              <div class="issue" *ngIf="row.seoScan.errCount.error > 0 ">
                <span class="indicator risk1"></span>
                <span class="text">
                  <span>{{row.seoScan.errCount.error}}</span>
                  <span *ngIf="row.seoScan.errCount.error == 1 "> Error</span>
                  <span *ngIf="row.seoScan.errCount.error > 1 "> Errors</span>
                </span>
              </div>
              <div class="issue" *ngIf="row.seoScan.errCount.warning > 0 ">
                <span class="indicator risk2"></span>
                <span class="text">
                  <span>{{row.seoScan.errCount.warning}}</span>
                  <span *ngIf="row.seoScan.errCount.warning == 1 "> Warning</span>
                  <span *ngIf="row.seoScan.errCount.warning  > 1 "> Warnings</span>
                </span>
              </div>
            </div>
          </span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column [resizeable]="false" [width]="150" [canAutoResize]="false">
        <ng-template let-column="column" ngx-datatable-header-template>
          Actions
        </ng-template>
        <ng-template let-row="row" ngx-datatable-cell-template>
          <div class="secondary-btn" *ngIf="row.seoScan">
            <button (click)="learnMoreOnIssue(row)">Details</button>
          </div>
          <div *ngIf="!row.seoScan">
            <span>Not scanned yet</span>
          </div>
        </ng-template>
      </ngx-datatable-column>

    </ngx-datatable>
  </div>
  <div class="no-data" *ngIf="products.length == 0">
    <span>No Products found</span>
    <!-- <app-no-data [message]="message"></app-no-data> -->
  </div>
</div>

<div class="overlay" [ngClass]="{active: planError == true}">
  <div class="popup" *ngIf="planError == true">
    <h3>Upgrade Plan to countinue</h3>
    <a class="close" (click)="changeBoolean('planError',false);">&times;</a>
    <div class="content">
      You need to Upgrade your plan to continue using our app.
    </div>
    <div class="flex align-items-center justify-content-center">
      <button class="btn" [routerLink]="['/pricing']">
        <span>Goto Pricing</span>
      </button>
    </div>
  </div>
</div>